<html><head><title>Code</title><style type="text/css"><!--/**
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 */
#s7 .de1, #s7 .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;}
#s7  {font-family:monospace;}
#s7 .imp {font-weight: bold; color: red;}
#s7 li, #s7 .li1 {font-weight: normal; vertical-align:top;}
#s7 .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
#s7 .kw1 {color: #0600FF; font-weight: bold;}
#s7 .kw2 {color: #FF8000; font-weight: bold;}
#s7 .kw3 {color: #008000;}
#s7 .kw4 {color: #6666cc; font-weight: bold;}
#s7 .kw5 {color: #000000;}
#s7 .co1 {color: #008080; font-style: italic;}
#s7 .co2 {color: #008080;}
#s7 .co3 {color: #008080;}
#s7 .coMULTI {color: #008080; font-style: italic;}
#s7 .es0 {color: #008080; font-weight: bold;}
#s7 .es_h {color: #008080; font-weight: bold;}
#s7 .br0 {color: #008000;}
#s7 .sy0 {color: #008000;}
#s7 .st0 {color: #666666;}
#s7 .st_h {color: #666666;}
#s7 .nu0 {color: #FF0000;}
#s7 .me1 {color: #0000FF;}
#s7 .me2 {color: #0000FF;}
#s7 span.xtra { display:block; }
#s7- { background:#FFAAEE; }--></style></head><pre class="csharp" id="s7"><ol><li class="li1" id="s7-1"><div class="de1"><span class="kw1">namespace</span> xsdClasses</div></li><li class="li1" id="s7-2"><div class="de1"><span class="br0">&#123;</span></div></li><li class="li1" id="s7-3"><div class="de1">    <span class="kw1">using</span> <span class="co3">System</span><span class="sy0">;</span></div></li><li class="li1" id="s7-4"><div class="de1">    <span class="kw1">using</span> <span class="co3">System.Collections.Generic</span><span class="sy0">;</span></div></li><li class="li1" id="s7-5"><div class="de1">    <span class="kw1">using</span> <span class="co3">System.Linq</span><span class="sy0">;</span></div></li><li class="li1" id="s7-6"><div class="de1">    <span class="kw1">using</span> <span class="co3">System.Text</span><span class="sy0">;</span></div></li><li class="li1" id="s7-7"><div class="de1">    <span class="kw1">using</span> <span class="co3">System.IO</span><span class="sy0">;</span></div></li><li class="li1" id="s7-8"><div class="de1">    <span class="kw1">using</span> <span class="co3">System.Xml.Serialization</span><span class="sy0">;</span></div></li><li class="li1" id="s7-9"><div class="de1"> </div></li><li class="li1" id="s7-10"><div class="de1">    <span class="kw1">public</span> <span class="kw1">static</span> <span class="kw4">class</span> Serialization</div></li><li class="li1" id="s7-11"><div class="de1">    <span class="br0">&#123;</span></div></li><li class="li1" id="s7-12"><div class="de1">        <span class="kw1">public</span> <span class="kw1">static</span> T Deserialize<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="kw4">string</span> fileName<span class="br0">&#41;</span> <span class="kw1">where</span> T<span class="sy0">:</span> <span class="kw4">class</span>, <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span></div></li><li class="li1" id="s7-13"><div class="de1">        <span class="br0">&#123;</span></div></li><li class="li1" id="s7-14"><div class="de1">             <span class="kw1">using</span> <span class="br0">&#40;</span>var fs <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> FileStream<span class="br0">&#40;</span>fileName, FileMode<span class="sy0">.</span><span class="me1">Open</span><span class="br0">&#41;</span><span class="br0">&#41;</span></div></li><li class="li1" id="s7-15"><div class="de1">                <span class="br0">&#123;</span></div></li><li class="li1" id="s7-16"><div class="de1">                    var xs <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> XmlSerializer<span class="br0">&#40;</span><a href="http://www.google.com/search?q=typeof+msdn.microsoft.com"><span class="kw3">typeof</span></a><span class="br0">&#40;</span>T<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span></div></li><li class="li1" id="s7-17"><div class="de1">                    var obj <span class="sy0">=</span> xs<span class="sy0">.</span><span class="me1">Deserialize</span><span class="br0">&#40;</span>fs<span class="br0">&#41;</span> <span class="kw1">as</span> T<span class="sy0">;</span></div></li><li class="li1" id="s7-18"><div class="de1">                    <span class="kw1">return</span> obj<span class="sy0">;</span></div></li><li class="li1" id="s7-19"><div class="de1">                <span class="br0">&#125;</span></div></li><li class="li1" id="s7-20"><div class="de1">            <span class="br0">&#125;</span></div></li><li class="li1" id="s7-21"><div class="de1"> </div></li><li class="li1" id="s7-22"><div class="de1">        <span class="kw1">public</span> <span class="kw1">static</span> <span class="kw4">void</span> Serialize<span class="br0">&#40;</span><span class="kw4">string</span> fileName, <span class="kw4">object</span> obj<span class="br0">&#41;</span></div></li><li class="li1" id="s7-23"><div class="de1">        <span class="br0">&#123;</span></div></li><li class="li1" id="s7-24"><div class="de1">            <span class="kw1">using</span> <span class="br0">&#40;</span>var fs <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> FileStream<span class="br0">&#40;</span>fileName, FileMode<span class="sy0">.</span><span class="me1">Create</span><span class="br0">&#41;</span><span class="br0">&#41;</span></div></li><li class="li1" id="s7-25"><div class="de1">            <span class="br0">&#123;</span></div></li><li class="li1" id="s7-26"><div class="de1">                var xs <span class="sy0">=</span> <a href="http://www.google.com/search?q=new+msdn.microsoft.com"><span class="kw3">new</span></a> XmlSerializer<span class="br0">&#40;</span>obj<span class="sy0">.</span><span class="me1">GetType</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span></div></li><li class="li1" id="s7-27"><div class="de1">                xs<span class="sy0">.</span><span class="me1">Serialize</span><span class="br0">&#40;</span>fs, obj<span class="br0">&#41;</span><span class="sy0">;</span></div></li><li class="li1" id="s7-28"><div class="de1">            <span class="br0">&#125;</span></div></li><li class="li1" id="s7-29"><div class="de1">        <span class="br0">&#125;</span></div></li><li class="li1" id="s7-30"><div class="de1">    <span class="br0">&#125;</span></div></li><li class="li1" id="s7-31"><div class="de1"><span class="br0">&#125;</span></div></li><li class="li1" id="s7-32"><div class="de1"> </div></li></ol></pre>